<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Parser</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Telegram Report Parser</h1>
        <textarea id="message" placeholder="Paste Telegram report here..."></textarea>
        <button onclick="submitData()">Submit to Google Sheets</button>
        <p id="response"></p>
    </div>

<script>
    async function submitData() {
        const message = document.getElementById("message").value;
        const responseEl = document.getElementById("response");
        const button = document.querySelector("button");

        // Show loading state
        button.disabled = true;
        button.innerText = "Submitting...";
        responseEl.innerText = ""; // clear previous response

        try {
            const res = await fetch("https://globe-tg-parser.onrender.com", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message }),
            });

            const data = await res.json();

            if (res.ok) {
                responseEl.innerText = "✅ " + (data.message || "Report submitted successfully!");
            } else {
                responseEl.innerText = "❌ Failed to submit: " + (data.message || "Unknown error");
            }
        } catch (error) {
            responseEl.innerText = "❌ Network error: " + error.message;
        } finally {
            // Restore button
            button.disabled = false;
            button.innerText = "Submit to Google Sheets";
        }
    }
</script>

</body>
</html>